<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XÄƒn Xeo ChÃ¡y TÃºi - Voucher Shopee</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .container { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 380px; width: 100%; position: relative; overflow: hidden; }
        .container::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #9b59b6, #8e44ad, #bb8fce); }
        .header { text-align: center; margin-bottom: 25px; }
        .logo { font-size: 28px; background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 5px; font-weight: bold; }
        .title { font-size: 18px; color: #7f8c8d; font-weight: 500; }
        .form-group { position: relative; margin-bottom: 20px; }
        .label { display: flex; align-items: center; font-size: 14px; color: #555; margin-bottom: 8px; }
        .label i { margin-right: 6px; color: #9b59b6; }
        input[type="url"] { width: 100%; padding: 16px 16px 16px 45px; border: 2px solid #e1e8ed; border-radius: 12px; font-size: 16px; background: #fafbfc; transition: all 0.3s; }
        input:focus { outline: none; border-color: #9b59b6; background: white; box-shadow: 0 0 0 3px rgba(155,89,182,0.1); }
        button { width: 100%; padding: 16px; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s; margin-bottom: 12px; }
        #btnGenerate { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white; box-shadow: 0 4px 15px rgba(155,89,182,0.3); }
        #btnGenerate:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(155,89,182,0.4); }
        #btnCopy { background: #95a5a6; color: white; }
        #btnCopy:hover { background: #7f8c8d; }
        #result { margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #e8f5e8, #f0f8f0); border: 1px solid #d4edda; border-radius: 12px; display: none; text-align: center; }
        #result.show { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        #shortUrl { color: #27ae60; text-decoration: none; font-weight: bold; font-size: 14px; word-break: break-all; display: block; margin-top: 8px; }.success-icon { font-size: 24px; color: #27ae60; margin-bottom: 10px; }
        @media (max-width: 480px) { .container { margin: 10px; padding: 24px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">ðŸ”¥ XÄƒn Xeo ChÃ¡y TÃºi</div>
            <div class="title"><i class="fas fa-tags"></i> Voucher Shopee</div>
        </div>
        <div class="form-group">
            <label class="label"><i class="fas fa-link"></i> DÃ¡n link sáº£n pháº©m Ä‘á»ƒ láº¥y voucher</label>
            <input type="url" id="inputLink" placeholder="DÃ¡n link">
        </div>
        <button id="btnGenerate" onclick="generateShortLink()">
            <i class="fas fa-gift"></i> Mua ngay voucher
        </button>
        <button id="btnCopy" onclick="copyLink()" style="display: none;">
            <i class="fas fa-copy"></i> Sao chÃ©p link
        </button>
        <div id="result">
            <div class="success-icon"><i class="fas fa-check-circle"></i></div>
            <strong>Link siÃªu ngáº¯n Ä‘Ã£ sáºµn sÃ ng!</strong><br>
            <a id="shortUrl" href="#" target="_blank"></a>
        </div>
    </div>

    <script>
        const AFFILIATE_ID = '17314740041';

        function extractItemShopId(url) {
            // Fix: Match má»i dáº¡ng link Shopee cÃ³ i[Sá»].[Sá»]
            const patterns = [
                /i\.(\d+)\.(\d+)/g,           // /i.123456789.987654321
                /\/i(\d+)\.(\d+)/g,           // /tÃªn-i123456789.987654321  
                /itemid=(\d+)&shopid=(\d+)/g, // ?itemid=123&shopid=456
                /product\/(\d+)\/(\d+)/g      // /product/123/456
            ];
            
            for (let pattern of patterns) {
                const match = url.match(pattern);
                if (match) return `${match[1]}.${match[2]}`;
            }
            return null;
        }

        function generateShortLink() {
            const input = document.getElementById('inputLink').value.trim();
            if (!input || !input.includes('shopee.vn')) {
                alert('âš ï¸ Vui lÃ²ng dÃ¡n link Shopee.vn sáº£n pháº©m!');
                return;
            }

            const itemShopId = extractItemShopId(input);
            if (!itemShopId) {
                alert('âš ï¸ KhÃ´ng tÃ¬m tháº¥y ID sáº£n pháº©m! Thá»­ link dáº¡ng:\nhttps://shopee.vn/tÃªn-i123456789.987654321');
                return;
            }

            // Táº¡o tracking link vá»›i ID siÃªu ngáº¯n
            const shortPath = itemShopId;
            const trackingLink = `https://s.shopee.vn/an_redir?origin_link=https%3A%2F%2Fshopee.vn%2F${shortPath}&affiliate_id=${AFFILIATE_ID}&sub_id=xanxeo-tool`;

            const resultDiv = document.getElementById('result');
            const shortUrlEl = document.getElementById('shortUrl');
            shortUrlEl.href = trackingLink;
            shortUrlEl.textContent = `https://shopee.vn/${shortPath}`;resultDiv.classList.add('show');
            document.getElementById('btnCopy').style.display = 'block';
            document.getElementById('inputLink').value = '';
        }

        function copyLink() {
            const link = document.getElementById('shortUrl').href;
            navigator.clipboard.writeText(link).then(() => {
                alert('âœ… ÄÃ£ copy link siÃªu ngáº¯n!\n(Chia sáº» nháº­n hoa há»“ng ðŸ’°)');
            }).catch(() => {
                prompt('Copy link tracking:', link);
            });
        }

        document.getElementById('inputLink').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') generateShortLink();
        });
    </script>
</body>
</html>
